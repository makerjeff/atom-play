<!DOCTYPE html>

<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Atom Play 01!</title>
  <meta name="viewport" contents="width=device_width, initial-scale=1.0">

  <style>

  </style>

</head>


<body>

<div id="room_select_div">
  <form id="room_select_form">
    <input id="room_select_input" type="text" autocomplete="off">
    <button id="room_select_button">join</button>
  </form>
</div>


  <button id="ping_button"> Ping! </button>

  <script src="/socket.io/socket.io.js"></script>
  <script>

  // handles
    let room_select_div = document.getElementById('room_select_div');
    let room_select_form = document.getElementById('room_select_form');
    let room_select_input = document.getElementById('room_select_input');
    let ping_button = document.getElementById('ping_button');

    // globals
    let room = '123abc';
    let socket = io.connect();

    // socket events
    socket.on('connect', () => {
      console.log(`connected to server. : ${Date.now()}`);
    });
    socket.on('message', (message) => {
      console.log(`from server: ${message} : ${Date.now()}`);
    });

    // --- helper functions ---
    function pinger(message) {
      console.log(`attempting to send _ping : ${Date.now()}`);
      socket.emit('_ping', message );
    }

    //TODO: get-current-room

    // --- event listeners ---
    room_select_form.addEventListener('submit', (e) => {
      e.preventDefault();

      let input = room_select_form.children[0];

      if (input.value == '') {
        console.log('input something!');
      } else {
        console.log(`Sending to server: ${input.value} : ${Date.now()}`);
        socket.emit('room', input.value);
        input.value = '';

      }
    });
    // Pinger event.
    ping_button.addEventListener('click', (ev) => {
      pinger(`I PINGED you!`);
    });

  </script>
</body>


</html>
